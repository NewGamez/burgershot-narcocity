<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Burgershot | Kleiderordnung</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <a href="index.html" class="brand-link">ðŸ‘• Burgershot Kleidung</a>
    <button onclick="location.href='index.html'">ZurÃ¼ck zum Dashboard</button>
</header>

<section class="dashboard">
    <div id="clothingCreator" class="panel full-width" style="display: none; margin-bottom: 30px;">
        <div class="panel-header" id="creatorTitle">âž• Neues Outfit eintragen</div>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
            <input type="text" id="clothTitle" placeholder="Name des Outfits (z.B. Service MÃ¤nnlich)">
            <input type="text" id="clothImg" placeholder="Bild-URL (Optional)">
            <textarea id="clothDesc" placeholder="Details (Mehrere Zeilen mÃ¶glich)&#10;Hose: ID 5&#10;Oberteil: ID 12..." style="grid-column: span 2; height: 100px; background: rgba(0,0,0,0.2); color: white; border: 1px solid var(--glass-border); padding: 10px; border-radius: 8px;"></textarea>
            <input type="hidden" id="editId">
            <button onclick="saveClothing()" class="submit-btn" style="grid-column: span 2;">Outfit speichern</button>
            <button id="cancelEdit" onclick="resetForm()" style="display:none; grid-column: span 2; background: #444;">Bearbeiten abbrechen</button>
        </div>
    </div>

    <div id="clothingGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
        </div>
</section>

<script src="script.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        requireLogin();
        if(isAdmin()) document.getElementById("clothingCreator").style.display = "block";
        renderClothing();
    });

    const getClothing = () => JSON.parse(localStorage.getItem("bs_clothing")) || [];

    function renderClothing() {
        const container = document.getElementById("clothingGrid");
        const items = getClothing();
        const admin = isAdmin();
        container.innerHTML = "";

        if(items.length === 0) {
            container.innerHTML = "<p style='grid-column: 1/-1; text-align:center; opacity:0.5;'>Keine Outfits eingetragen.</p>";
            return;
        }

        items.forEach(item => {
            const div = document.createElement("div");
            div.className = "panel";
            div.style.display = "flex";
            div.style.flexDirection = "column";

            div.innerHTML = `
                <div class="panel-header" style="color: var(--primary);">${item.title}</div>
                ${item.img ? `<img src="${item.img}" style="width:100%; border-radius:8px; margin: 10px 0;">` : ''}
                <p style="white-space: pre-line; font-size: 0.9rem; margin: 10px 0; flex-grow: 1;">${item.desc}</p>
                ${admin ? `
                <div style="display: flex; gap: 10px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px; margin-top: auto;">
                    <button onclick="editClothing(${item.id})" style="flex:1; background: rgba(255,255,255,0.1); font-size: 0.8rem;">Bearbeiten</button>
                    <button onclick="deleteClothing(${item.id})" style="flex:1; background: rgba(231, 76, 60, 0.2); color: #e74c3c; border: 1px solid #e74c3c; font-size: 0.8rem;">LÃ¶schen</button>
                </div>` : ''}
            `;
            container.appendChild(div);
        });
    }

    function saveClothing() {
        const title = document.getElementById("clothTitle").value;
        const img = document.getElementById("clothImg").value;
        const desc = document.getElementById("clothDesc").value;
        const editId = document.getElementById("editId").value;
        
        if(!title || !desc) return alert("Bitte Titel und Details ausfÃ¼llen!");

        let items = getClothing();

        if(editId) {
            const index = items.findIndex(i => i.id == editId);
            items[index] = { ...items[index], title, img, desc };
        } else {
            items.push({ id: Date.now(), title, img, desc });
        }

        localStorage.setItem("bs_clothing", JSON.stringify(items));
        resetForm();
        renderClothing();
    }

    function editClothing(id) {
        const item = getClothing().find(i => i.id == id);
        document.getElementById("clothTitle").value = item.title;
        document.getElementById("clothImg").value = item.img;
        document.getElementById("clothDesc").value = item.desc;
        document.getElementById("editId").value = item.id;
        
        document.getElementById("creatorTitle").innerText = "âœï¸ Outfit bearbeiten";
        document.getElementById("cancelEdit").style.display = "block";
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function resetForm() {
        document.getElementById("clothTitle").value = "";
        document.getElementById("clothImg").value = "";
        document.getElementById("clothDesc").value = "";
        document.getElementById("editId").value = "";
        document.getElementById("creatorTitle").innerText = "âž• Neues Outfit eintragen";
        document.getElementById("cancelEdit").style.display = "none";
    }

    function deleteClothing(id) {
        if(!confirm("Outfit wirklich lÃ¶schen?")) return;
        let items = getClothing().filter(i => i.id !== id);
        localStorage.setItem("bs_clothing", JSON.stringify(items));
        renderClothing();
    }
</script>
</body>
</html>
