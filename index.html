<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Burgershot Intern | Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <a href="index.html" class="brand-link">ğŸ” Burgershot Intern</a>
    <div>
        <span id="welcomeUser" style="margin-right: 15px; opacity: 0.8;"></span>
        <button onclick="logout()">Logout</button>
    </div>
</header>

<section class="dashboard-wrapper" style="padding: 20px; max-width: 1400px; margin: 0 auto;">
    
    <div class="panel hero-panel" style="display: flex; justify-content: space-between; align-items: center; padding: 30px; margin-bottom: 25px; cursor: default; background: linear-gradient(135deg, rgba(20, 20, 25, 0.9) 0%, rgba(250, 172, 21, 0.1) 100%);">
        <div style="display: flex; align-items: center; gap: 20px;">
            <img src="assets/logo.png" alt="Logo" style="width: 50px;">
            <div>
                <h1 style="color: var(--primary); font-size: 1.6rem; margin: 0;">Willkommen bei Burgershot Intern</h1>
                <p style="opacity: 0.7; margin: 5px 0 0 0;">Teamverwaltung & Organisation auf einen Blick.</p>
            </div>
        </div>
        <div style="display: flex; gap: 40px; text-align: center;">
            <div>
                <div id="accCount" style="font-size: 2rem; font-weight: 800; color: var(--primary);">30</div>
                <div style="font-size: 0.65rem; opacity: 0.6; text-transform: uppercase; letter-spacing: 1px;">Accounts</div>
            </div>
            <div>
                <div id="heroAbmCount" style="font-size: 2rem; font-weight: 800; color: var(--primary);">0</div>
                <div style="font-size: 0.65rem; opacity: 0.6; text-transform: uppercase; letter-spacing: 1px;">Offene Abmeldungen</div>
            </div>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 25px;">
        
        <div class="panel" onclick="location.href='news.html'" style="cursor: pointer; min-height: 140px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <span class="panel-header" style="color: var(--primary); font-weight: bold; font-size: 0.9rem;">ğŸ“¢ NEWS & INFOS</span>
                <span id="newsCounter" class="badge" style="background: var(--primary); color: black; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: bold;">0</span>
            </div>
            <p style="font-size: 0.85rem; opacity: 0.8;">Wichtige AnkÃ¼ndigungen fÃ¼r das Team.</p>
        </div>

        <div class="panel" onclick="openAbmModal()" style="cursor: pointer; min-height: 140px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <span class="panel-header" style="color: var(--primary); font-weight: bold; font-size: 0.9rem;">ğŸ“… ABMELDUNGEN</span>
                <span id="abmCounter" class="badge" style="background: var(--primary); color: black; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: bold;">0 offen</span>
            </div>
            <p style="font-size: 0.85rem; opacity: 0.8;">Klicke hier, um eine neue Abmeldung einzureichen.</p>
        </div>

        <div class="panel" style="min-height: 140px; grid-column: span 1;">
            <span class="panel-header" style="color: var(--primary); font-weight: bold; font-size: 0.9rem;">ğŸ“ Neuen Bewerber eintragen</span>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px;">
                <input type="text" id="bewName" placeholder="Name" style="padding: 6px; font-size: 0.8rem;">
                <input type="text" id="bewGeb" placeholder="Geburtsdatum" style="padding: 6px; font-size: 0.8rem;">
                <input type="text" id="bewTel" placeholder="Telefon" style="padding: 6px; font-size: 0.8rem;">
                <input type="text" id="bewVisum" placeholder="Visum" style="padding: 6px; font-size: 0.8rem;">
                <input type="text" id="bewZivi" placeholder="Zivi/Frak" style="padding: 6px; font-size: 0.8rem;">
                <select id="bewersch" style="padding: 6px; font-size: 0.8rem; background: rgba(0,0,0,0.3); color: white; border: 1px solid rgba(255,255,255,0.1); border-radius: 4px;">
                    <option value="">Erscheinungsbild</option>
                    <option value="10">10</option>
                    <option value="10">9</option>
                    <option value="10">8</option>
                    <option value="10">7</option>
                    <option value="10">6</option>
                    <option value="10">5</option>
                    <option value="10">4</option>
                    <option value="5">3</option>
                    <option value="1">2</option>
                    <option value="10">1</option>
                </select>
            </div>
            <button onclick="submitBewerbung()" style="width: 100%; margin-top: 10px; padding: 6px; font-size: 0.8rem;">Bewerber speichern</button>
        </div>

        <div class="panel" onclick="location.href='announcements.html'" style="cursor: pointer; min-height: 140px;">
            <span class="panel-header" style="color: var(--primary); font-weight: bold; font-size: 0.9rem;">ğŸ“¢ BUSINESS ANNOUNCEMENTS</span>
            <p style="font-size: 0.85rem; opacity: 0.8; margin-top: 10px;">Vorlagen fÃ¼r Werbetexte ansehen & hinzufÃ¼gen.</p>
            <small style="opacity: 0.4; font-size: 0.7rem; display: block; margin-top: 10px;">Vollbildansicht Ã¶ffnen</small>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 25px;">
        <div class="panel" style="padding: 15px; text-align: center; cursor: pointer;" onclick="location.href='bestellungen.html'">ğŸ“¦ Orders</div>
        <div class="panel" style="padding: 15px; text-align: center; cursor: pointer;" onclick="location.href='lager.html'">ğŸ­ Lager</div>
        <div class="panel" style="padding: 15px; text-align: center; cursor: pointer;" onclick="location.href='musik.html'">ğŸµ Musik</div>
        <div class="panel" style="padding: 15px; text-align: center; cursor: pointer;" onclick="location.href='kleidung.html'">ğŸ‘• Kleidung</div>
    </div>

    <div class="panel" style="cursor: default;">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
            <span style="opacity: 0.5;">ğŸ”˜</span>
            <span class="panel-header" style="font-weight: bold;">MEINE AKTUELLEN ANTRÃ„GE</span>
        </div>
        <div id="meineAbmeldungenList">
            <p style="opacity: 0.5; font-size: 0.9rem;">Du hast aktuell keine Abmeldungen eingereicht.</p>
        </div>
    </div>

    <div id="adminPanel" class="management-bar" onclick="location.href='management.html'" style="margin-top: 25px; display: none; background: rgba(250, 172, 21, 0.1); border: 1px solid var(--primary); padding: 15px; border-radius: 12px; justify-content: space-between; align-items: center; cursor: pointer;">
        <div style="display: flex; align-items: center; gap: 15px;">
            <span style="font-size: 1.2rem;">â­</span>
            <div>
                <div style="font-weight: bold; color: var(--primary);">Management Center</div>
                <div style="font-size: 0.75rem; opacity: 0.7;">Personalverwaltung & Systemsteuerung</div>
            </div>
        </div>
        <span style="font-size: 1.2rem;">â”</span>
    </div>
</section>

<div class="modal-backdrop" id="abmModal">
    <div class="modal">
        <h2>ğŸ“… Abmeldung schreiben</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
            <input type="text" id="abmVon" placeholder="Von (z.B. 24.02.)">
            <input type="text" id="abmBis" placeholder="Bis (z.B. 01.03.)">
        </div>
        <textarea id="abmGrund" placeholder="Grund fÃ¼r die Abwesenheit..." style="width: 100%; height: 100px; margin-top: 10px;"></textarea>
        <div style="display: flex; gap: 10px; margin-top: 20px;">
            <button onclick="submitAbmeldungUI()" style="flex: 2;">Absenden</button>
            <button onclick="closeAbmModal()" style="flex: 1; background: #444;">Abbrechen</button>
        </div>
    </div>
</div>

<script src="script.js"></script>
<script>
    requireLogin();
    
   document.addEventListener("DOMContentLoaded", () => {
    // 1. Variablen holen
    const adminPanel = document.getElementById("adminPanel");
    const user = sessionStorage.getItem("loggedInUser");
    const role = sessionStorage.getItem("userRole");

    // 2. Debugging-Infos (nur fÃ¼r dich in F12 sichtbar)
    console.log("--- Dashboard Check ---");
    console.log("User:", user);
    console.log("Rolle:", role);

    // 3. Willkommens-Text setzen
    const welcomeElem = document.getElementById("welcomeUser");
    if (welcomeElem) {
        welcomeElem.innerText = "Willkommen, " + (user || "Gast");
    }

    // 4. Management Bar Logik
    if (adminPanel) {
        if (isAdmin()) { 
            console.log("Ergebnis isAdmin(): TRUE -> Zeige Panel");
            adminPanel.style.display = "flex"; 
        } else {
            console.log("Ergebnis isAdmin(): FALSE -> Verstecke Panel");
            adminPanel.style.display = "none";
        }
    }

    // 5. Statistiken und Listen laden (falls vorhanden)
    if (typeof updateDashboardStats === "function") updateDashboardStats();
    if (typeof renderMeineAbmeldungen === "function") renderMeineAbmeldungen();
});
</script>
    
    <script src="script.js"></script>
</body>
</html>
