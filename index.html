<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Burgershot Intern</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div class="header-left">
        <a href="index.html" class="brand-link">ğŸ” Burgershot Intern</a>
    </div>
    <div class="header-right">
        <span id="welcomeUser"></span>
        <button class="logout-btn" onclick="logout()">Logout</button>
    </div>
</header>

<section class="dashboard">

    <!-- TOP PANELS -->
    <div class="top-panels">

        <div class="panel big">
            ğŸ“¢ Business Announcements
        </div>

        <div class="panel big gold" id="managementPanel" onclick="openManagement()">
            ğŸ‘‘ Management Center
        </div>

    </div>

    <!-- SECOND ROW -->
    <div class="middle-panels">

        <div class="panel small">ğŸ‘• Kleiderordnung</div>
        <div class="panel small">ğŸµ Musik</div>
        <div class="panel small">ğŸ“… Abmeldungen</div>

    </div>

    <!-- THIRD ROW -->
    <div class="middle-panels">

        <div class="panel small">ğŸ‘¥ Mitarbeiter</div>
        <div class="panel small">ğŸ“ Bewerber</div>
        <div class="panel small">ğŸ“¦ EinkÃ¤ufe</div>

    </div>

</section>
    
    <div class="modal-backdrop" id="changePassModal" style="display:none;">
    <div class="modal">
        <h2>Sicherheitsschub</h2>
        <p>Da dies dein erster Login ist, musst du dein 4-stelliges Passwort Ã¤ndern.</p>
        <input type="password" id="newPassInput" placeholder="Neue 4-stellige PIN" maxlength="4" 
               style="width:80%; padding:10px; margin-bottom:20px; border-radius:10px; border:none; background:rgba(255,255,255,0.1); color:white; text-align:center;">
        <br>
        <button onclick="updatePassword()">Passwort speichern</button>
    </div>
</div>

<footer>
    Burgershot Internal System Â© 2026
</footer>

<!-- MODAL -->
<div class="modal-backdrop" id="noAccessModal">
    <div class="modal">
        <h2>Keine Berechtigung</h2>
        <p>Du hast nicht die nÃ¶tige Rolle, um das Management Center zu betreten.</p>
        <button onclick="closeModal()">Verstanden</button>
    </div>
</div>

<script src="script.js"></script>

<script>
requireLogin();
setHeaderUser();

function openManagement() {
    if (isAdmin()) {
        window.location.href = "management.html";
    } else {
        document.getElementById("noAccessModal").style.display = "flex";
    }
}

function closeModal() {
    document.getElementById("noAccessModal").style.display = "none";
}

    function checkFirstLogin() {
    const username = sessionStorage.getItem("loggedInUser");
    const accounts = getAccounts();
    const user = accounts[username];

    if (user && user.isFirstLogin) {
        document.getElementById("changePassModal").style.display = "flex";
    }
}

function updatePassword() {
    const newPass = document.getElementById("newPassInput").value.trim();
    const username = sessionStorage.getItem("loggedInUser");
    const accounts = getAccounts();

    if (newPass.length !== 4 || isNaN(newPass)) {
        alert("Das Passwort muss aus genau 4 Zahlen bestehen.");
        return;
    }

    accounts[username].password = newPass;
    accounts[username].isFirstLogin = false; // Status auf erledigt setzen
    saveAccounts(accounts);
    
    document.getElementById("changePassModal").style.display = "none";
    alert("Passwort erfolgreich gesetzt!");
}

// Beim Laden der Seite prÃ¼fen
checkFirstLogin();
</script>

</body>
</html>
