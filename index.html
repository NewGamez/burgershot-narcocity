<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Burgershot Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <a href="index.html" class="brand-link">ğŸ” BURGERSHOT INTERN</a>
    <div style="display: flex; align-items: center; gap: 20px;">
        <span id="welcomeUser" style="color: var(--primary); font-weight: bold;"></span>
        <button onclick="logout()">Logout</button>
    </div>
</header>

<section class="dashboard">
    <div class="dashboard-grid">
        <div class="panel" onclick="location.href='abmeldungen.html'">
            <div class="panel-header">ğŸ“… Abmeldungen</div>
            <p style="opacity: 0.7;">Verwalte deine Abwesenheiten.</p>
        </div>

        <div class="panel" onclick="location.href='bewerber.html'">
            <div class="panel-header">ğŸ“ Bewerber</div>
            <p style="opacity: 0.7;">Neue Anfragen sichten.</p>
        </div>

        <div class="panel" onclick="location.href='lager.html'">
            <div class="panel-header">ğŸ›’ Lager & EinkÃ¤ufe</div>
            <p style="opacity: 0.7;">Bestand kontrollieren.</p>
        </div>

        <div id="adminPanel" class="panel" style="display:none; border: 1px solid var(--primary);" onclick="location.href='management.html'">
            <div class="panel-header">â­ MANAGEMENT</div>
            <p style="color: var(--primary);">Personalverwaltung & System</p>
        </div>
    </div>
</section>

<div class="modal-backdrop" id="pinModal" style="display:none;">
    <div class="modal">
        <h2 style="color: var(--primary); margin-bottom: 20px;">ğŸ”’ PIN Ã¤ndern</h2>
        <p style="margin-bottom: 20px;">Bitte setze deine persÃ¶nliche 4-stellige PIN.</p>
        <input type="password" id="newPin" maxlength="4" style="width: 120px; text-align: center; font-size: 1.5rem;">
        <br><br>
        <button onclick="savePin()">Speichern</button>
    </div>
</div>

<script src="script.js"></script>
<script>
    requireLogin();
    window.onload = () => {
        const user = sessionStorage.getItem("loggedInUser");
        document.getElementById("welcomeUser").innerText = user;
        
        if (isAdmin()) {
            document.getElementById("adminPanel").style.display = "block";
        }

        const accs = getAccounts();
        if (accs[user] && accs[user].isFirstLogin) {
            document.getElementById("pinModal").style.display = "flex";
        }
    };

    function savePin() {
        const pin = document.getElementById("newPin").value;
        const user = sessionStorage.getItem("loggedInUser");
        const accs = getAccounts();
        if (pin.length === 4 && !isNaN(pin)) {
            accs[user].password = pin;
            accs[user].isFirstLogin = false;
            saveAccounts(accs);
            document.getElementById("pinModal").style.display = "none";
            alert("PIN erfolgreich gesetzt!");
        } else {
            alert("Bitte 4 Zahlen eingeben!");
        }
    }
</script>
</body>
</html>
