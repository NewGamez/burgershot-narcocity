<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Burgershot Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <a href="index.html" class="brand-link">ğŸ” BURGERSHOT INTERN</a>
    <div>
        <span id="welcomeUser" style="color: var(--primary); font-weight: bold;"></span>
        <button onclick="logout()">Logout</button>
    </div>
</header>

<section class="dashboard">
    <div class="dashboard-grid">

        <div class="panel">
            <div class="panel-header">ğŸ“… Abmeldungen</div>
            <p>Verwalte deine Abwesenheiten.</p>
        </div>

        <div class="panel">
            <div class="panel-header">ğŸ“ Bewerber</div>
            <p>Neue Anfragen sichten.</p>
        </div>

        <div class="panel">
            <div class="panel-header">ğŸ“¦ Lager & EinkÃ¤ufe</div>
            <p>Bestand kontrollieren.</p>
        </div>

        <div id="adminPanel" class="panel" style="display:none; border:1px solid var(--primary);" onclick="location.href='management.html'">
            <div class="panel-header">â­ MANAGEMENT</div>
            <p style="color: var(--primary);">Personalverwaltung & System</p>
        </div>

    </div>
</section>

<div class="modal-backdrop" id="pinModal" style="display:none;">
    <div class="modal">
        <h2 style="color: var(--primary); margin-bottom: 20px;">ğŸ”’ PIN Ã¤ndern</h2>
        <p>Bitte setze deine persÃ¶nliche 4-stellige PIN.</p>
        <br>
        <input type="password" id="newPin" maxlength="4" style="width:120px; text-align:center; font-size:1.5rem;">
        <br><br>
        <button onclick="savePin()">Speichern</button>
    </div>
</div>

<script src="script.js"></script>
<script>
requireLogin();

window.onload = () => {
    const user = sessionStorage.getItem("loggedInUser");
    const accs = getAccounts();

    document.getElementById("welcomeUser").innerText = "Willkommen, " + user;

    if (isAdmin()) {
        document.getElementById("adminPanel").style.display = "block";
    }

    if (accs[user].isFirstLogin) {
        document.getElementById("pinModal").style.display = "flex";
    }
};

function savePin() {
    const pin = document.getElementById("newPin").value.trim();
    const user = sessionStorage.getItem("loggedInUser");
    const accs = getAccounts();

    if (/^\d{4}$/.test(pin)) {
        accs[user].password = pin;
        accs[user].isFirstLogin = false;
        saveAccounts(accs);
        document.getElementById("pinModal").style.display = "none";
        alert("PIN erfolgreich gesetzt!");
    } else {
        alert("Bitte genau 4 Zahlen eingeben!");
    }
}
</script>

</body>
</html>
