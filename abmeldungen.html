<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Abmeldungen</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <a href="index.html" class="brand-link">â† ZurÃ¼ck</a>
    <button class="add-btn" onclick="document.getElementById('modal').style.display='flex'">+ Neue Abmeldung</button>
</header>

<section class="dashboard">
    <div class="panel full-width">
        <div class="table-head">
            <span>Mitarbeiter</span>
            <span>Zeitraum</span>
            <span>Grund</span>
            <span style="text-align:right;">Aktion</span>
        </div>
        <div id="absenceList"></div>
    </div>
</section>

<div class="modal-backdrop" id="modal" style="display:none;">
    <div class="modal">
        <h3 style="margin-bottom:15px; color:var(--accent);">Neue Abmeldung</h3>
        <input type="text" id="inName" class="input-field" placeholder="Dein Name" style="width:100%; margin-bottom:10px;">
        <input type="text" id="inTime" class="input-field" placeholder="Zeitraum (z.B. 24.02.-01.03.)" style="width:100%; margin-bottom:10px;">
        <textarea id="inReason" class="input-field" placeholder="Grund" style="width:100%; height:80px; margin-bottom:15px;"></textarea>
        <div style="display:flex; gap:10px;">
            <button class="add-btn" onclick="addEntry()" style="flex:1;">Speichern</button>
            <button class="add-btn" style="background:#444; color:white; flex:1;" onclick="document.getElementById('modal').style.display='none'">Abbrechen</button>
        </div>
    </div>
</div>

<script src="script.js"></script>
<script>
    requireLogin();
    function render() {
        const list = document.getElementById("absenceList");
        list.innerHTML = "";
        getAbsences().reverse().forEach(item => {
            const row = document.createElement("div");
            row.className = "table-row";
            row.innerHTML = `
                <span class="bold">${item.name}</span>
                <span>${item.time}</span>
                <span class="reason-text">${item.reason}</span>
                <div style="text-align:right;"><button class="delete-btn-small" onclick="del(${item.id})">ğŸ—‘ï¸</button></div>
            `;
            list.appendChild(row);
        });
    }
    function addEntry() {
        const name = document.getElementById("inName").value;
        const time = document.getElementById("inTime").value;
        const reason = document.getElementById("inReason").value;
        if(!name || !time) return alert("Name/Zeitraum fehlt!");
        const data = getAbsences();
        data.push({ id: Date.now(), name, time, reason });
        saveAbsences(data);
        location.reload();
    }
    function del(id) {
        if(confirm("LÃ¶schen?")) {
            saveAbsences(getAbsences().filter(i => i.id !== id));
            render();
        }
    }
    window.onload = render;
</script>
</body>
</html>
