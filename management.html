<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Management</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<script>
if (!sessionStorage.getItem("loggedInUser")) {
    window.location.href = "login.html";
}
</script>

<header>
    <div class="header-left">
        <a href="index.html" class="brand-link">üçî Burgershot Intern</a>
    </div>

    <div class="header-right">
        <span id="welcomeUser"></span>
        <button class="logout-btn" onclick="logout()">Logout</button>
    </div>
</header>

<section class="dashboard">

<div class="big-panel gold">

    <h3>Neuen Account erstellen</h3>

    <div class="form-group">
        <input type="text" id="newUsername" placeholder="Benutzername">
        <input type="password" id="newPassword" placeholder="4-stelliges Passwort" maxlength="4">
    </div>

    <button class="create-btn" onclick="createAccount()">Account erstellen</button>

</div>

<div class="big-panel account-list">

    <h3>Erstellte Accounts</h3>

    <div class="account-table">
        <div class="account-row header">
            <span>Benutzername</span>
            <span>Rolle</span>
            <span>Aktion</span>
        </div>

        <div id="accountList"></div>
    </div>

</div>

</section>

<footer>
    Burgershot Internal System ¬© 2026
</footer>

<script>

const user = sessionStorage.getItem("loggedInUser");
document.getElementById("welcomeUser").innerText = "Eingeloggt als: " + user;

function logout() {
    sessionStorage.removeItem("loggedInUser");
    window.location.href = "login.html";
}

function createAccount() {
    const username = document.getElementById("newUsername").value.trim();
    const password = document.getElementById("newPassword").value.trim();

    if (!username) return alert("Benutzername fehlt.");
    if (password.length !== 4) return alert("Passwort muss 4-stellig sein.");

    let accounts = JSON.parse(localStorage.getItem("accounts")) || {};

    if (accounts[username]) return alert("Account existiert bereits.");

    accounts[username] = {
        password: password,
        role: "Mitarbeiter"
    };

    localStorage.setItem("accounts", JSON.stringify(accounts));
    loadAccounts();
}

function loadAccounts() {
    let accounts = JSON.parse(localStorage.getItem("accounts")) || {};
    const list = document.getElementById("accountList");
    list.innerHTML = "";

    Object.keys(accounts).forEach(username => {

        const row = document.createElement("div");
        row.className = "account-row";

        row.innerHTML = `
            <span class="account-name">${username}</span>

            <select class="role-select" onchange="changeRole('${username}', this.value)">
                <option ${accounts[username].role === "Mitarbeiter" ? "selected" : ""}>Mitarbeiter</option>
                <option ${accounts[username].role === "Manager" ? "selected" : ""}>Manager</option>
                <option ${accounts[username].role === "Admin" ? "selected" : ""}>Admin</option>
            </select>

            <button class="delete-btn" onclick="deleteAccount('${username}')">L√∂schen</button>
        `;

        list.appendChild(row);
    });
}

function changeRole(username, role) {
    let accounts = JSON.parse(localStorage.getItem("accounts")) || {};
    accounts[username].role = role;
    localStorage.setItem("accounts", JSON.stringify(accounts));
}

function deleteAccount(username) {
    let accounts = JSON.parse(localStorage.getItem("accounts")) || {};
    delete accounts[username];
    localStorage.setItem("accounts", JSON.stringify(accounts));
    loadAccounts();
}

loadAccounts();

</script>

</body>
</html>
