<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Management</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div class="header-left">
        <a href="index.html" class="brand-link">üçî Burgershot Intern</a>
    </div>
    <div class="header-right">
        <span id="welcomeUser"></span>
        <button class="logout-btn" onclick="logout()">Logout</button>
    </div>
</header>

<section class="dashboard">

<div class="panel large">

    <h2>Neuen Account erstellen</h2>

    <input type="text" id="newUsername" placeholder="Benutzername">
    <input type="password" id="newPassword" placeholder="4-stelliges Passwort" maxlength="4">

    <select id="newRole">
        <option>Mitarbeiter</option>
        <option>Manager</option>
        <option>Admin</option>
    </select>

    <button onclick="createAccount()">Erstellen</button>

</div>

<div class="panel large">

    <h2>Erstellte Accounts</h2>
    <div id="accountList"></div>

</div>

</section>

<script src="script.js"></script>
<script>
requireLogin();
setHeaderUser();

if (!isAdmin()) {
    window.location.href = "index.html";
}

function createAccount() {
    const username = document.getElementById("newUsername").value.trim();
    const password = document.getElementById("newPassword").value.trim();
    const role = document.getElementById("newRole").value;

    if (!username || password.length !== 4) {
        alert("Ung√ºltige Eingabe.");
        return;
    }

    const accounts = getAccounts();

    if (accounts[username]) {
        alert("Account existiert bereits.");
        return;
    }

    accounts[username] = { password, role };
    saveAccounts(accounts);
    loadAccounts();
}

function deleteAccount(username) {
    const accounts = getAccounts();
    delete accounts[username];
    saveAccounts(accounts);
    loadAccounts();
}

function loadAccounts() {
    const accounts = getAccounts();
    const list = document.getElementById("accountList");
    list.innerHTML = "";

    Object.keys(accounts).forEach(username => {
        const div = document.createElement("div");
        div.className = "account-row";

        div.innerHTML = `
            <span>${username}</span>
            <span>${accounts[username].role}</span>
            <button onclick="deleteAccount('${username}')">L√∂schen</button>
        `;

        list.appendChild(div);
    });
}

loadAccounts();
</script>

</body>
</html>
