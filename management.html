<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Management Center</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<header>
    <a href="index.html" class="brand-link">‚Üê Zur√ºck</a>
    <span style="color: gold; font-weight: bold;">Management Center</span>
</header>

<section class="dashboard">
    <div class="panel full-width">
        <h3 style="margin-bottom:20px; color:gold;">üë§ Personalverwaltung</h3>
        
        <div class="hiring-bar">
            <input type="text" id="newName" placeholder="Name">
            <select id="newRole">
                <option value="Mitarbeiter_in">Mitarbeiter/in</option>
                <option value="Management">Management</option>
                <option value="Cheffe">Cheffe</option>
            </select>
            <button class="add-btn" onclick="addUser()">Einstellen</button>
        </div>

        <div class="account-table-header">
            <span>Name</span>
            <span>Rang</span>
            <span style="text-align:right;">Aktion</span>
        </div>
        <div id="userList"></div>
    </div>
</section>

<script src="script.js"></script>
<script>
    requireLogin();
    if(!isAdmin()) window.location.href = "index.html";

    function renderUsers() {
        const list = document.getElementById("userList");
        list.innerHTML = "";
        const accs = getAccounts();
    
        Object.keys(accs).forEach(name => {
            const row = document.createElement("div");
            row.className = "mgmt-grid"; // Benutzt jetzt das neue Grid-System
            row.innerHTML = `
                <span style="font-weight:bold;">${name}</span>
                <span style="color: #bbb;">${accs[name].role}</span>
                <div style="text-align:right;">
                    ${name !== 'Admin' ? `<button class="btn-danger" onclick="delUser('${name}')">K√ºndigen</button>` : ''}
                </div>
            `;
            list.appendChild(row);
        });
    }

    function addUser() {
        const name = document.getElementById("newName").value.trim();
        const role = document.getElementById("newRole").value;
        const accs = getAccounts();
        if(name && !accs[name]) {
            accs[name] = { password: "0000", role: role, isFirstLogin: true };
            saveAccounts(accs);
            renderUsers();
            document.getElementById("newName").value = "";
        } else {
            alert("Name ung√ºltig oder bereits vergeben.");
        }
    }

    function delUser(name) {
        if(name === "Admin") return alert("Admin kann nicht gel√∂scht werden.");
        if(confirm(name + " k√ºndigen?")) {
            const accs = getAccounts();
            delete accs[name];
            saveAccounts(accs);
            renderUsers();
        }
    }
    window.onload = renderUsers;
</script>
</body>
</html>
